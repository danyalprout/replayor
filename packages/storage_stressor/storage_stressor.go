package storage_stressor

import (
	"sort"
	"strings"

	"github.com/ethereum/go-ethereum/common"
)

const StorageStressorBytecode = "6080604052348015600e575f80fd5b50611c4e8061001c5f395ff3fe608060405234801561000f575f80fd5b5060043610610086575f3560e01c806361bc221a1161005957806361bc221a14610110578063a52b4b2e1461012e578063a6690f291461015e578063ca3be9681461018e57610086565b8063067bd3b41461008a57806308811397146100a85780633033e2c9146100d857806341720c3e146100f4575b5f80fd5b6100926101aa565b60405161009f91906109d8565b60405180910390f35b6100c260048036038101906100bd9190610a1f565b6101b0565b6040516100cf9190610a89565b60405180910390f35b6100f260048036038101906100ed9190610a1f565b6101eb565b005b61010e60048036038101906101099190610a1f565b6102ee565b005b610118610412565b60405161012591906109d8565b60405180910390f35b61014860048036038101906101439190610ad5565b610418565b6040516101559190610b0f565b60405180910390f35b61017860048036038101906101739190610b28565b61042c565b6040516101859190610b0f565b60405180910390f35b6101a860048036038101906101a39190610a1f565b61044c565b005b60035481565b600481815481106101bf575f80fd5b905f5260205f20015f915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f60035490505f5b828110156102d1575f3343838561020a9190610b93565b60405160200161021c93929190610bc6565b6040516020818303038152906040528051906020012090505f81604051610242906109b3565b8190604051809103905ff590508015801561025f573d5f803e3d5ffd5b509050600481908060018154018082558091505060019003905f5260205f20015f9091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550505080806001019150506101f3565b508160035f8282546102e39190610b93565b925050819055505050565b5f5b8181101561040e575f428260025460405160200161031093929190610bfb565b6040516020818303038152906040528051906020012090505f818360405160200161033c929190610c30565b604051602081830303815290604052805190602001209050805f808481526020019081526020015f20819055505f8260405160200161037b9190610cb1565b6040516020818303038152906040528051906020012090508160015f8581526020019081526020015f205f8381526020019081526020015f20819055508181847f011dffd9d644b95c4df64d6f9232574df3cdf317df2d4807d1783d9c0c20f64160405160405180910390a460025f8154809291906103f990610cdd565b919050555050505080806001019150506102f0565b5050565b60025481565b5f602052805f5260405f205f915090505481565b6001602052815f5260405f20602052805f5260405f205f91509150505481565b5f600567ffffffffffffffff81111561046857610467610d24565b5b6040519080825280602002602001820160405280156104965781602001602082028036833780820191505090505b5090505f600567ffffffffffffffff8111156104b5576104b4610d24565b5b6040519080825280602002602001820160405280156104e35781602001602082028036833780820191505090505b5090505f5b60058110156105bd578042604051602001610504929190610d51565b6040516020818303038152906040528051906020012083828151811061052d5761052c610d78565b5b6020026020010181815250506001816105469190610b93565b5f1b82828151811061055b5761055a610d78565b5b60200260200101818152505081818151811061057a57610579610d78565b5b60200260200101515f8085848151811061059757610596610d78565b5b602002602001015181526020019081526020015f208190555080806001019150506104e8565b505f5b838110156109ad575f6005826105d69190610dd2565b90505f805f8684815181106105ee576105ed610d78565b5b602002602001015181526020019081526020015f205490505f805f8760056001876106199190610b93565b6106239190610dd2565b8151811061063457610633610d78565b5b602002602001015181526020019081526020015f205490505f82824287600254604051602001610668959493929190610e02565b6040516020818303038152906040528051906020012090505f83838360405160200161069693929190610e53565b6040516020818303038152906040528051906020012090505f826040516020016106c09190610ed2565b6040516020818303038152906040528051906020012090505f816040516020016106ea9190610f48565b6040516020818303038152906040528051906020012090505f816040516020016107149190610fbe565b604051602081830303815290604052805190602001209050835f808781526020019081526020015f20819055508360015f8781526020019081526020015f205f8581526020019081526020015f20819055508360015f8581526020019081526020015f205f8481526020019081526020015f20819055508360015f8481526020019081526020015f205f8381526020019081526020015f2081905550848b89815181106107c4576107c3610d78565b5b602002602001018181525050838a89815181106107e4576107e3610d78565b5b6020026020010181815250505f60038a6107fe9190610dd2565b03610885575f6002548a604051602001610819929190611034565b6040516020818303038152906040528051906020012090505f805f8381526020019081526020015f20549050808660405160200161085892919061106e565b604051602081830303815290604052805190602001205f808481526020019081526020015f208190555050505b5f60048a6108939190610dd2565b036108f4575f5b60058110156108f2575f8a826040516020016108b79291906110df565b604051602081830303815290604052805190602001209050855f808381526020019081526020015f208190555050808060010191505061089a565b505b8383867f011dffd9d644b95c4df64d6f9232574df3cdf317df2d4807d1783d9c0c20f64160405160405180910390a48382847f011dffd9d644b95c4df64d6f9232574df3cdf317df2d4807d1783d9c0c20f64160405160405180910390a48381837f011dffd9d644b95c4df64d6f9232574df3cdf317df2d4807d1783d9c0c20f64160405160405180910390a460025f81548092919061099390610cdd565b9190505550505050505050505080806001019150506105c0565b50505050565b610aff8061111a83390190565b5f819050919050565b6109d2816109c0565b82525050565b5f6020820190506109eb5f8301846109c9565b92915050565b5f80fd5b6109fe816109c0565b8114610a08575f80fd5b50565b5f81359050610a19816109f5565b92915050565b5f60208284031215610a3457610a336109f1565b5b5f610a4184828501610a0b565b91505092915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610a7382610a4a565b9050919050565b610a8381610a69565b82525050565b5f602082019050610a9c5f830184610a7a565b92915050565b5f819050919050565b610ab481610aa2565b8114610abe575f80fd5b50565b5f81359050610acf81610aab565b92915050565b5f60208284031215610aea57610ae96109f1565b5b5f610af784828501610ac1565b91505092915050565b610b0981610aa2565b82525050565b5f602082019050610b225f830184610b00565b92915050565b5f8060408385031215610b3e57610b3d6109f1565b5b5f610b4b85828601610ac1565b9250506020610b5c85828601610ac1565b9150509250929050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f610b9d826109c0565b9150610ba8836109c0565b9250828201905080821115610bc057610bbf610b66565b5b92915050565b5f606082019050610bd95f830186610a7a565b610be660208301856109c9565b610bf360408301846109c9565b949350505050565b5f606082019050610c0e5f8301866109c9565b610c1b60208301856109c9565b610c2860408301846109c9565b949350505050565b5f604082019050610c435f830185610b00565b610c5060208301846109c9565b9392505050565b5f82825260208201905092915050565b7f6e657374656400000000000000000000000000000000000000000000000000005f82015250565b5f610c9b600683610c57565b9150610ca682610c67565b602082019050919050565b5f604082019050610cc45f830184610b00565b8181036020830152610cd581610c8f565b905092915050565b5f610ce7826109c0565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203610d1957610d18610b66565b5b600182019050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b5f604082019050610d645f8301856109c9565b610d7160208301846109c9565b9392505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f610ddc826109c0565b9150610de7836109c0565b925082610df757610df6610da5565b5b828206905092915050565b5f60a082019050610e155f830188610b00565b610e226020830187610b00565b610e2f60408301866109c9565b610e3c60608301856109c9565b610e4960808301846109c9565b9695505050505050565b5f606082019050610e665f830186610b00565b610e736020830185610b00565b610e806040830184610b00565b949350505050565b7f6c6576656c3100000000000000000000000000000000000000000000000000005f82015250565b5f610ebc600683610c57565b9150610ec782610e88565b602082019050919050565b5f604082019050610ee55f830184610b00565b8181036020830152610ef681610eb0565b905092915050565b7f6c6576656c3200000000000000000000000000000000000000000000000000005f82015250565b5f610f32600683610c57565b9150610f3d82610efe565b602082019050919050565b5f604082019050610f5b5f830184610b00565b8181036020830152610f6c81610f26565b905092915050565b7f6c6576656c3300000000000000000000000000000000000000000000000000005f82015250565b5f610fa8600683610c57565b9150610fb382610f74565b602082019050919050565b5f604082019050610fd15f830184610b00565b8181036020830152610fe281610f9c565b905092915050565b7f64697374616e74000000000000000000000000000000000000000000000000005f82015250565b5f61101e600783610c57565b915061102982610fea565b602082019050919050565b5f6060820190508181035f83015261104b81611012565b905061105a60208301856109c9565b61106760408301846109c9565b9392505050565b5f6040820190506110815f830185610b00565b61108e6020830184610b00565b9392505050565b7f73636174746572656400000000000000000000000000000000000000000000005f82015250565b5f6110c9600983610c57565b91506110d482611095565b602082019050919050565b5f6060820190508181035f8301526110f6816110bd565b905061110560208301856109c9565b61111260408301846109c9565b939250505056fe6080604052348015600e575f80fd5b50433073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f77594c7fa34419efb1eaaabf29a576f56c88a9b7877b9c55a53c74da44ad609e60405160405180910390a4610a88806100775f395ff3fe608060405234801561000f575f80fd5b50600436106100f3575f3560e01c80635cd6b973116100955780639ae918c7116100645780639ae918c7146102e3578063bcb37b5e14610313578063da5633ef14610343578063e3186c5614610373576100f3565b80635cd6b9731461022357806361ce60ad146102535780636f5adccf146102835780639a94947b146102b3576100f3565b8063254ddc51116100d1578063254ddc511461018757806333ae8158146101b757806337101f09146101d55780635a0aa04f14610205576100f3565b80630f96cf34146100f75780631cc9841f1461012757806321c7489514610157575b5f80fd5b610111600480360381019061010c91906106ac565b6103a3565b60405161011e9190610716565b60405180910390f35b610141600480360381019061013c919061072f565b6103d7565b60405161014e919061077c565b60405180910390f35b610171600480360381019061016c91906106ac565b61040e565b60405161017e919061077c565b60405180910390f35b6101a1600480360381019061019c9190610795565b61042f565b6040516101ae919061077c565b60405180910390f35b6101bf61045b565b6040516101cc9190610855565b60405180910390f35b6101ef60048036038101906101ea91906106ac565b6104e8565b6040516101fc919061077c565b60405180910390f35b61020d610509565b60405161021a91906108c7565b60405180910390f35b61023d600480360381019061023891906106ac565b610596565b60405161024a919061077c565b60405180910390f35b61026d600480360381019061026891906106ac565b6105ac565b60405161027a9190610901565b60405180910390f35b61029d6004803603810190610298919061072f565b6105d6565b6040516102aa919061077c565b60405180910390f35b6102cd60048036038101906102c8919061094d565b6105f7565b6040516102da9190610987565b60405180910390f35b6102fd60048036038101906102f891906106ac565b61060d565b60405161030a919061077c565b60405180910390f35b61032d600480360381019061032891906106ac565b610625565b60405161033a919061077c565b60405180910390f35b61035d600480360381019061035891906109ca565b610646565b60405161036a919061077c565b60405180910390f35b61038d600480360381019061038891906106ac565b61065c565b60405161039a9190610987565b60405180910390f35b60c881606481106103b2575f80fd5b015f915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b61013382815481106103e7575f80fd5b905f5260205f200181815481106103fc575f80fd5b905f5260205f20015f91509150505481565b610131818154811061041e575f80fd5b905f5260205f20015f915090505481565b610138602052825f5260405f20602052815f5260405f20602052805f5260405f205f9250925050505481565b610139805461046990610a22565b80601f016020809104026020016040519081016040528092919081815260200182805461049590610a22565b80156104e05780601f106104b7576101008083540402835291602001916104e0565b820191905f5260205f20905b8154815290600101906020018083116104c357829003601f168201915b505050505081565b61013081815481106104f8575f80fd5b905f5260205f20015f915090505481565b61013a805461051790610a22565b80601f016020809104026020016040519081016040528092919081815260200182805461054390610a22565b801561058e5780601f106105655761010080835404028352916020019161058e565b820191905f5260205f20905b81548152906001019060200180831161057157829003601f168201915b505050505081565b610134602052805f5260405f205f915090505481565b61012c81606481106105bc575f80fd5b60209182820401919006915054906101000a900460ff1681565b610137602052815f5260405f20602052805f5260405f205f91509150505481565b610136602052805f5260405f205f915090505481565b5f816064811061061b575f80fd5b015f915090505481565b6101328181548110610635575f80fd5b905f5260205f20015f915090505481565b610135602052805f5260405f205f915090505481565b6064816064811061066b575f80fd5b015f915090505481565b5f80fd5b5f819050919050565b61068b81610679565b8114610695575f80fd5b50565b5f813590506106a681610682565b92915050565b5f602082840312156106c1576106c0610675565b5b5f6106ce84828501610698565b91505092915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610700826106d7565b9050919050565b610710816106f6565b82525050565b5f6020820190506107295f830184610707565b92915050565b5f806040838503121561074557610744610675565b5b5f61075285828601610698565b925050602061076385828601610698565b9150509250929050565b61077681610679565b82525050565b5f60208201905061078f5f83018461076d565b92915050565b5f805f606084860312156107ac576107ab610675565b5b5f6107b986828701610698565b93505060206107ca86828701610698565b92505060406107db86828701610698565b9150509250925092565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f610827826107e5565b61083181856107ef565b93506108418185602086016107ff565b61084a8161080d565b840191505092915050565b5f6020820190508181035f83015261086d818461081d565b905092915050565b5f81519050919050565b5f82825260208201905092915050565b5f61089982610875565b6108a3818561087f565b93506108b38185602086016107ff565b6108bc8161080d565b840191505092915050565b5f6020820190508181035f8301526108df818461088f565b905092915050565b5f8115159050919050565b6108fb816108e7565b82525050565b5f6020820190506109145f8301846108f2565b92915050565b5f819050919050565b61092c8161091a565b8114610936575f80fd5b50565b5f8135905061094781610923565b92915050565b5f6020828403121561096257610961610675565b5b5f61096f84828501610939565b91505092915050565b6109818161091a565b82525050565b5f60208201905061099a5f830184610978565b92915050565b6109a9816106f6565b81146109b3575f80fd5b50565b5f813590506109c4816109a0565b92915050565b5f602082840312156109df576109de610675565b5b5f6109ec848285016109b6565b91505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f6002820490506001821680610a3957607f821691505b602082108103610a4c57610a4b6109f5565b5b5091905056fea26469706673582212201860886eb66ba91a449f6390e8144215f84423bde1bbb0828efdca250373c0c964736f6c634300081a0033a26469706673582212208f82692609325f82440eca53498be44b8687caebb53040c1957ce93c4d97fdb764736f6c634300081a0033"

var StorageStressorSignatures = map[string][]byte{
	"writeStorage":    common.Hex2Bytes("41720c3e"), // cast sig "writeStorage(uint256)"
	"writeStorage2":   common.Hex2Bytes("ca3be968"), // cast sig "writeStorage2(uint256)"
	"deployContracts": common.Hex2Bytes("3033e2c9"), // cast sig "deployContracts(uint256)"
}

func GetValidStorageStressorNames() string {
	names := make([]string, 0, len(StorageStressorSignatures))
	for name := range StorageStressorSignatures {
		names = append(names, name)
	}
	sort.Strings(names) // Sort for consistent output
	return strings.Join(names, ", ")
}
